<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 다른 mapper와 중복되지 않도록 네임스페이스 기재 -->
<!-- mapper - mybatis, sqlMap - ibatis -->
<mapper namespace="payment">
	<insert id="insertPayment">
		INSERT INTO PAYMENT
			(ORDER_NO,
		    MEM_ID,
		    MEM_NAME,
			PAYMENT_METHOD,
			PAYMENT_STATE,
			PAYMENT_DATE,
			PAYMENT_PRICE)
		SELECT
			T.ORDER_NO,
		    M.MEM_ID,
		    M.MEM_NAME,
		    '무통장입금',
		    T.ORDER_STATE,
		    NOW(),
		    SUM(T.PRICE)
		FROM 
		    TRANSACTION T
		JOIN 
		    MEMBER M ON T.MEM_ID = M.MEM_ID
		WHERE 
		    M.MEM_ID = 'test123'
		GROUP BY
		    T.ORDER_NO;
	
	</insert>
	
</mapper> 