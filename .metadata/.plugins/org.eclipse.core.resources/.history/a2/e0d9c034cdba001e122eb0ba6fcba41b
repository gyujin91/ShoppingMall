<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<c:set var="path" value="${pageContext.request.contextPath }" />
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제품 상세보기</title>
    <link rel="stylesheet" href="${path }/resources/css/normalize.css">
    <link rel="stylesheet" href="${path }/resources/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
    
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    
    <style>
    .itetmDetail
    {
        display: flex;
        justify-content: center;
        margin: 0 auto;
        width: 1200px;
        height: 600px;
        margin-top: 80px;
        margin-bottom: 80px;
    }
    .itetmDetail .imgBox 
    {
        width: 560px;
    }
    .itetmDetail .imgBox img
    {
        width: 100%;
        height: 100%;
    }
    .itetmDetail .detail
    {
        width: 50%;
        height: 100%;
        padding-left: 100px;
    }
    .itetmDetail .detail h3
    {
        text-align: center;
        border-bottom: 1px solid rgba(33, 33, 33, 0.15);
        padding-bottom: 15px;
        font-size: 1.3em;
    }
    .itetmDetail .detail .info
    {
        width: 100%;
        height: 360px;
    }
    .itetmDetail .detail .info table
    {
        border-bottom: 1px solid rgba(33, 33, 33, 0.15);
        width: 100%;
        border-spacing: 50px;
        border-collapse: separate;
       
    }
    .itetmDetail .detail .info table .sizeSelect
    {
        width: 150px;
        border: 1px solid #c4c4c4;
        box-sizing:  border-box;
        border-radius: 10px;
        text-align: center;
    }
    .itetmDetail .detail .info table .sizeSelect:focus
    {
        border: 1px solid #9b51e0;
        box-sizing: border-box;
        border-radius: 10px;
        outline: 3px solid #f834ff;
    }
    .itetmDetail .detail .info table .quantitySelect
    {
        width: 100px;
        border: 1px solid #c4c4c4;
        box-sizing:  border-box;
        border-radius: 10px;
        text-align: center;
    }
    .itetmDetail .detail .info table .quantitySelect:focus
    {
        border: 1px solid #9b51e0;
        box-sizing: border-box;
        border-radius: 10px;
        outline: 3px solid #f834ff;
    }
    .itetmDetail .detail .total
    {
        border-bottom: 1px solid rgba(33, 33, 33, 0.15);
        padding-top: 30px;
        padding-bottom: 30px;
        text-align: right;
        margin-top: 60px;
    }
    .itetmDetail .detail .buy
    {
        margin-top: 40px;
    }
    .itetmDetail .detail .btn_group
    {
        text-align: right;
    }
    .itetmDetail .detail .btn_group button
    {
        margin-left: 5px;
    }
    .itetmDetail .detail .btn_group .xicon
    {
        width: 60px;
        height: 56px;
        background-color: #fff;
        border: 1px solid rgba(33, 33, 33, 0.15);
    }
    .itetmDetail .detail .btn_group .buy
    {
        width: 280px;
        height: 56px;
        background: #2f2f2f;
        color: #fff;
        font-weight: bold;
    }
    
    .total strong span
    {
        margin-left: 10px;
    }
    .total .size {
        margin-right: 50px;
    }
</style>
</head>



<body>
   <%@ include file="../include/header.jsp" %>
    <div class="itetmDetail">
        <div class="imgBox">
            <img src="${path }/resources/img/${dto.prod_image }" alt="상품 이미지">
        </div>
        <div class="detail">
            <h3>${dto.prod_name }</h3>
            <div class="info">
                <table>          
                    <tr>
                        <th>브랜드</th>
                        <td>${dto.brand }</td>
                    </tr>
                    <tr>
                        <th>판매가</th>
                        <td><fmt:formatNumber pattern="###,###,###" value="${dto.price}"/></td>
                    </tr>
                    <tr>
                        <th>사이즈</th>
                        <td>
                            <select name="sizeSelect" id="sizeSelect" class="sizeSelect" onchange="updateSize()">
                                <option value="option">옵션선택</option>
                                <option value="S">S</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th>수량</th>
                        <td>
                            <select name="quantitySelect" id="quantitySelect" class="quantitySelect" onchange="updateValue()">
                                <option value="1">1개</option>
                                <option value="2">2개</option>
                                <option value="3">3개</option>
                                <option value="4">4개</option>
                                <option value="5">5개</option>
                                <option value="6">6개</option>
                                <option value="7">7개</option>
                                <option value="8">8개</option>
                                <option value="9">9개</option>
                                <option value="10">10개</option>
                              </select>
                        </td>
                    </tr>
                    <tr>
                        <th>배송비</th>
                        <td>${dto.deliveryFee }</td>
                    </tr>
                </table>
            </div>
            <div class="total">
            	<strong class="size" id="sizeText">SIZE :</strong>
                <strong>TOTAL :<span id="totalValue"></span> (<span id="quantityValue"></span>개)</strong>
              </div>
            <div class="btn_group">
                <button type="button" class="xicon"><i class="xi-heart-o"></i></button>
                <button type="button" class="xicon"><i class="xi-cart-o"></i></button>
                <button type="button" class="buy">바로구매</button>
            </div>
        </div>
        
    </div>

   
    <%@ include file="../include/footer.jsp" %>
 	
 	<script>
    	// <select> 요소와 TOTAL 값에 대한 요소들을 가져오기
	    const selectElement = document.getElementById('quantitySelect');
	    const totalValueElement = document.getElementById('totalValue');
	    const quantityValueElement = document.getElementById('quantityValue');
	
	    // <select> 요소의 change 이벤트에 대한 핸들러를 등록
	    selectElement.addEventListener('change', function() {
	    // 선택된 옵션의 value 값을 가져오기
	    const selectedValue = selectElement.value;
	
	    // TOTAL 값을 업데이트
	    totalValueElement.textContent = selectedValue;
	    quantityValueElement.textContent = selectedValue;
	    });
	    
	    function updateSize() {
	        var selectElement = document.getElementById("sizeSelect");
	        var sizeTextElement = document.getElementById("sizeText");
	        var selectedValue = selectElement.value;

	        sizeTextElement.textContent = "SIZE: " + selectedValue;
	    }

	 // 서버에서 받은 가격 데이터
	    var price = '${dto.price}';

	    function updateValue() {
	        var selectElement = document.getElementById("sizeSelect");
	        var quantityValueElement = document.getElementById("quantityValue");
	        var selectedValue = selectElement.value;

	        // 가격 및 수량에 따른 VALUE 계산
	        var quantity = parseInt(quantityValueElement.textContent) || 0; // 이전 수량 가져오기, 없으면 0으로 설정

	        // VALUE 계산
	        var value = price * quantity;

	        // 수량 업데이트
	        quantityValueElement.textContent = quantity;

	        // VALUE 업데이트
	        var valueText = value.toLocaleString() + "원";
	        var valueElement = document.getElementById("valueElement");
	        valueElement.textContent = valueText;
	    }

	 	// 수량 변경 이벤트 감지
	    var selectElement = document.getElementById("sizeSelect");
	    selectElement.addEventListener("change", function() {
	        updateValue();
	    });

	
	</script>
</body>
</html>